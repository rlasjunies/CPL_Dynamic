var core;(function(n){(function(t){var u=function(){function n(){this.callbacks=[]}return n}(),i,r,f;t.Thread=u,i=function(){function t(t,i){this.once=!1,this.guid=n.misc.GUID_new(),this.callback=t,i&&(this.args=i)}return t}(),t.CallBackSubscribbed=i,r=function(){function n(n,t){this.thread=n,this.guid=t}return n}(),t.PubSubToken=r,f=function(){function t(){this._threads=[]}return t.prototype.subscribe=function(t,f,e){var o=n.misc.getObjectClass(t),h,s;return this._threads[o]||(this._threads[o]=new u),h=this._threads[o],s=new i(f,e),h.callbacks.push(s),new r(o,s.guid)},t.prototype.subscribeOnce=function(n,t,i){var f=this.subscribe(n,t,i),r,u;if(this._threads[f.thread])for(r=this._threads[f.thread],u=r.callbacks.length;u--;)r.callbacks[u].guid===f.guid&&(r.callbacks[u].once=!0)},t.prototype.unsubscribe=function(n){if(this._threads[n.thread])for(var t=this._threads[n.thread],i=t.callbacks.length;i--;)t.callbacks[i].guid===n.guid&&t.callbacks.splice(i,1)},t.prototype.publish=function(t){var u=n.misc.getObjectClass(t),i,r;if(this._threads[u])for(i=this._threads[u],r=i.callbacks.length;r--;)i.callbacks[r].args?i.callbacks[r].callback(t,i.callbacks[r].args):i.callbacks[r].callback(t),i.callbacks[r].once&&(console.log("PubSub.RemoveOnceMessages"),i.callbacks.splice(r,1))},t}(),t.PubSub=f})(n.pubsub||(n.pubsub={}));var t=n.pubsub})(core||(core={}))