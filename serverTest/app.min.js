function uploadFile(){var n=new FormData,t;n.append("fileToUpload",document.getElementById("fileToUpload").files[0]),n.append("submit",document.getElementById("form1")),t=new rest.RESTRequest("http://cpairelasjunies.com/php/"),t.request(rest.eRequestVerb.POST,"pictures",n,function(n){var t,i,r;switch(n.status()){case rest.enumRestStatus.failed:document.getElementById("fileUploadResult").innerHTML="Upload failed>>"+n.error()+"<<<";break;case rest.enumRestStatus.success:t=n.response(),document.getElementById("fileUploadedID").innerHTML=t.status,console.log(t.value.id),i=document.getElementById("testDivFileId"),i.innerHTML=t.value.id,globImageUploaded=t.value.id,r=document.getElementById("testDivStart"),r.style.display="block"}})}function startTest(){$("#testDivResultSucceed").html("0"),$("#testDivResultFailed").html("0"),$("#listResult").empty(),$.mobile.changePage("#pageTestResult");var n=new rest.RESTRequest("http://cpairelasjunies.com/rest.php/");paintsTests=new restPaintsTests(n),publish(new cmdStartTest)}function app(){return _app}function subscribe(n,t,i){return app().PubSub.subscribe(n,t,i)}function publish(n){app().PubSub.publish(n)}var restPicturesTests=function(){function n(n){this._imageCreatedForTest=n}return n.prototype.test_getListOfPictures=function(n,t){var i=new rest.RESTRequest("http://cpairelasjunies.com/php/");i.request(rest.eRequestVerb.GET,"pictures","",function(i){var r,u;switch(i.status()){case rest.enumRestStatus.failed:n(i.error(),"test_getListOfPictures");break;case rest.enumRestStatus.success:r=i.response(),r.status==="success"?(console.log(JSON.stringify(r.value)),t("test_getListOfPictures")):(u="status: Failed - "+r.error.message,n(Error(u),"test_getListOfPictures"))}})},n.prototype.test_deletePicture=function(n,t){var i=new rest.RESTRequest("http://cpairelasjunies.com/php/");i.request(rest.eRequestVerb.DELETE,"pictures/"+this._imageCreatedForTest,"",function(i){var r,u;switch(i.status()){case rest.enumRestStatus.failed:n(i.error(),"test_deletePicture");break;case rest.enumRestStatus.success:r=i.response(),r.status==="success"?(console.log(JSON.stringify(r.value)),t("test_deletePicture")):(u="status: Failed - "+r.error.message,n(Error(u),"test_deletePicture"))}})},n}(),restPaintsTests=function(){function n(n){this._paints=new models.Paints(n)}return n.prototype.test_postPaint=function(n){var t=n,i;app().PubSub.publish(new cmdTestAdd(t,"Paints","New")),i=this,app().PubSub.subscribeOnce(new models.evtPaintNewed(null,null,null),function(n){n.error?app().PubSub.publish(new evtTestFinished(t,!1,"Failed creating Painting: "+n.error)):(i._paint.id=n.value.id,app().PubSub.publish(new evtTestFinished(t,!0,"Painting created ID: "+n.value.id)))}),this._paint=new models.Paint("notDefined","testName","testDescription","testYear 2013 May 5","test/pictures/azertyuiop.jpg"),this._paints.new(this._paint)},n.prototype.test_UpdatePaint=function(n){var t=n,i;app().PubSub.publish(new cmdTestAdd(t,"Paints","Update")),i=this,app().PubSub.subscribeOnce(new models.evtPaintUpdated(null,null,null),function(n){n.error?app().PubSub.publish(new evtTestFinished(t,!1,"Failed updating Painting: "+n.error)):app().PubSub.publish(new evtTestFinished(t,!0,"Painting updated: "+JSON.stringify(n.value)))}),this._paint.name="updated",this._paint.description="updated",this._paint.year="updated",this._paint.picture="updated",this._paints.update(this._paint.id,this._paint)},n.prototype.test_DeletePaint=function(n){var t=n,i;app().PubSub.publish(new cmdTestAdd(t,"Paints","Delete")),i=this,app().PubSub.subscribeOnce(new models.evtPaintDeleted(null,null,null),function(n){n.error?app().PubSub.publish(new evtTestFinished(t,!1,"Failed deleting Painting: "+n.error)):app().PubSub.publish(new evtTestFinished(t,!0,"Painting deleting ID: "+n.value))}),this._paints.delete(this._paint.id)},n.prototype.test_getPaint=function(n){var t=n,i;app().PubSub.publish(new cmdTestAdd(t,"Paints","Get")),i=this,app().PubSub.subscribeOnce(new models.evtPaintGetted(null,null,null),function(n){n.error?app().PubSub.publish(new evtTestFinished(t,!1,"Failed getting Painting ID: "+i._paint.id+" ..."+n.error)):app().PubSub.publish(new evtTestFinished(t,!0,"Painting retrieved: "+JSON.stringify(n.value)))}),this._paints.get(this._paint.id)},n.prototype.test_getAll=function(){var n=core.misc.GUID_new(),t;app().PubSub.publish(new cmdTestAdd(n,"Paints","GetAll")),t=this,app().PubSub.subscribeOnce(new models.evtPaintsGetted(null,null,null),function(i){i.error?app().PubSub.publish(new evtTestFinished(n,!1,"Failed getting all Painting ID: "+t._paint.id+" ..."+i.error)):app().PubSub.publish(new evtTestFinished(n,!0,"Painting retrieved all: "+JSON.stringify(i.value)))}),this._paints.getAll()},n}(),globImageUploaded,paintsTests,_app;window.onload=function(){_app=new core.App(window,!1),subscribe(new cmdStartTest,function(){paintsTests.test_postPaint(createPaintTestID),paintsTests.test_getAll()}),subscribe(new evtTestFinished(null,null,null),function(n){n.passed&&n.guid===createPaintTestID?paintsTests.test_getPaint(getPaintTestID):n.passed&&n.guid===getPaintTestID?paintsTests.test_UpdatePaint(updatePaintTestID):n.passed&&n.guid===updatePaintTestID&&paintsTests.test_DeletePaint(deletePaintTestID)}),subscribe(new cmdTestAdd("","",""),function(n){$("#listResult").append("<li id='"+n.guid+"' group='"+n.group+"' ><h3>"+n.name+"<\/h3><p style='color:white' id='"+n.guid+"result'><\/p><\/li>"),$("#listResult").listview("refresh")}),subscribe(new evtTestFinished("",!0,""),function(n){var t=n.message.substr(0,100)+(n.message.length>100?" ...":"");n.passed?($("#"+n.guid+">:first").addClass("good"),$("#"+n.guid+">:first").html($("#"+n.guid+">:first").html()+"... passed"),$("#"+n.guid+"result").html(t),$("#"+n.guid).wrapInner("<a href='/' style='text-decoration:none'>"),$("#testDivResultSucceed").html(""+(parseInt($("#testDivResultSucceed").html())+1))):($("#"+n.guid+">:first").addClass("bad"),$("#"+n.guid+">:first").html($("#"+n.guid+">:first").html()+"... failed"),$("#"+n.guid+"result").html(t),$("#"+n.guid).wrapInner("<a href='/index.php' style='text-decoration:none'>"),$("#testDivResultFailed").html(""+(parseInt($("#testDivResultFailed").html())+1))),$("#listResult").listview("refresh")}),$.mobile.listview.prototype.options.autodividersSelector=function(n){var t=$.trim(n.attr("group"))||null;return t?t:null}};var cmdStartTest=function(){function n(){}return n}(),cmdTestAdd=function(){function n(n,t,i){this.guid=n,this.group=t,this.name=i}return n}(),evtTestFinished=function(){function n(n,t,i){this.guid=n,this.passed=t,this.message=i}return n}(),createPaintTestID=core.misc.GUID_new(),getPaintTestID=core.misc.GUID_new(),updatePaintTestID=core.misc.GUID_new(),deletePaintTestID=core.misc.GUID_new()