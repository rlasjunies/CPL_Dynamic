var core;(function(n){(function(t){var u=function(){function n(){this.callbacks=[]}return n}(),i,r,f;t.Thread=u,i=function(){function t(t){this.once=!1,this.guid=n.misc.GUID_new(),this.callback=t}return t}(),t.CallBackSubscribbed=i,r=function(){function n(n,t){this.thread=n,this.guid=t}return n}(),t.PubSubToken=r,f=function(){function t(){this._threads=[]}return t.prototype.subscribe=function(t,f){var e=n.misc.getObjectClass(t),s,o;return this._threads[e]||(this._threads[e]=new u),s=this._threads[e],o=new i(f),s.callbacks.push(o),new r(e,o.guid)},t.prototype.subscribeOnce=function(n,t){var u=this.subscribe(n,t),i,r;if(this._threads[u.thread])for(i=this._threads[u.thread],r=i.callbacks.length;r--;)i.callbacks[r].guid===u.guid&&(i.callbacks[r].once=!0)},t.prototype.unsubscribe=function(n){if(this._threads[n.thread])for(var t=this._threads[n.thread],i=t.callbacks.length;i--;)t.callbacks[i].guid===n.guid&&t.callbacks.splice(i,1)},t.prototype.publish=function(t){var u=n.misc.getObjectClass(t),i,r;if(this._threads[u])for(i=this._threads[u],r=i.callbacks.length;r--;)i.callbacks[r].args?i.callbacks[r].callback(t,i.callbacks[r].args):i.callbacks[r].callback(t),i.callbacks[r].once&&(console.log("PubSub.RemoveOnceMessages"),i.callbacks.splice(r,1))},t}(),t.PubSub=f})(n.pubsub||(n.pubsub={}));var t=n.pubsub})(core||(core={}))